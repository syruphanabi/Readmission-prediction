{"paragraphs":[{"text":"import org.apache.spark.rdd.RDD\nimport org.apache.commons.io.IOUtils\nimport java.net.URL\nimport java.nio.charset.Charset\nimport org.apache.spark.sql._","user":"anonymous","dateUpdated":"2018-04-21T20:50:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.rdd.RDD\nimport org.apache.commons.io.IOUtils\nimport java.net.URL\nimport java.nio.charset.Charset\nimport org.apache.spark.sql._\n"}]},"apps":[],"jobName":"paragraph_1524284761375_-161793152","id":"20180421-042601_1074506772","dateCreated":"2018-04-21T04:26:01+0000","dateStarted":"2018-04-21T20:50:42+0000","dateFinished":"2018-04-21T20:50:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3790"},{"text":"//load readmission records\r\nval one_setDF = sqlContext.read\r\n    .format(\"csv\")\r\n    .option(\"header\", \"true\") // Use first line of all files as header\r\n    .option(\"treatEmptyValuesAsNulls\",\"true\")\r\n    .option(\"inferSchema\", \"true\") // Automatically infer data types\r\n    .load(\"file:///mnt/host/home/doris/share-windows/p_set_m.csv\")","user":"anonymous","dateUpdated":"2018-04-22T21:02:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524285186708_410325173","id":"20180421-043306_139306186","dateCreated":"2018-04-21T04:33:06+0000","dateStarted":"2018-04-22T21:02:40+0000","dateFinished":"2018-04-22T21:02:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3792","errorMessage":""},{"text":"//load non-readmission records\r\nval zero_setDF = sqlContext.read\r\n    .format(\"csv\")\r\n    .option(\"header\", \"true\") // Use first line of all files as header\r\n    .option(\"treatEmptyValuesAsNulls\",\"true\")\r\n    .option(\"inferSchema\", \"true\") // Automatically infer data types\r\n    .load(\"file:///mnt/host/home/doris/share-windows/n_set_m.csv\")","user":"anonymous","dateUpdated":"2018-04-22T21:00:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524296427177_1717835664","id":"20180421-074027_2124774254","dateCreated":"2018-04-21T07:40:27+0000","dateStarted":"2018-04-21T20:52:35+0000","dateFinished":"2018-04-21T20:52:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3793","errorMessage":""},{"text":"//define a function for processing strings\r\ndef fixChars(str: String): String = {\r\n  val st = str.replaceAll(\"[0-9]\", \" \").toLowerCase //replace all numbers with blankspace and tranform strings to lowercase\r\n \r\n  val substitutions = Map(\r\n    '/' -> ' ',\r\n    '\\\\' -> ' ',\r\n    ',' -> ' ',\r\n    ';' -> ' ',\r\n    '[' -> ' ',\r\n    ']' -> ' ',\r\n    '*' -> ' ',\r\n    '\\n' -> ' ',\r\n    '$' -> ' ',\r\n    '+' -> ' ',\r\n    '=' -> ' ',\r\n    '+' -> ' ',\r\n    '=' -> ' ',\r\n    '#' -> ' ',\r\n    '.' -> ' ',\r\n    '?' -> ' ',\r\n    '|' -> ' ',\r\n    '^' -> ' ',\r\n    ':' -> ' ',\r\n    '(' -> ' ',\r\n    ')' -> ' ',\r\n    '{' -> ' ',\r\n    '}' -> ' ',\r\n    '\\\"'-> ' '\r\n)\r\n  val fixed = st.map(c => substitutions.getOrElse(c, c))\r\n  fixed\r\n}","user":"anonymous","dateUpdated":"2018-04-22T21:04:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"fixChars: (str: String)String\n"}]},"apps":[],"jobName":"paragraph_1524285207203_-39046218","id":"20180421-043327_1877471108","dateCreated":"2018-04-21T04:33:27+0000","dateStarted":"2018-04-22T21:04:27+0000","dateFinished":"2018-04-22T21:04:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3797"},{"text":"//process the readmission records\nval one_set_transformed = one_setDF.map(x => (x(4).toString,fixChars(x(5).toString)))","user":"anonymous","dateUpdated":"2018-04-22T21:07:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"one_set_transformed: org.apache.spark.sql.Dataset[(String, String)] = [_1: string, _2: string]\n"}]},"apps":[],"jobName":"paragraph_1524285211020_-169076022","id":"20180421-043331_76372635","dateCreated":"2018-04-21T04:33:31+0000","dateStarted":"2018-04-22T21:05:04+0000","dateFinished":"2018-04-22T21:05:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3798"},{"text":"//process the non-readmission records\nval zero_set_transformed = zero_setDF.map(x => (x(4).toString,fixChars(x(5).toString)))","user":"anonymous","dateUpdated":"2018-04-22T21:05:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"zero_set_transformed: org.apache.spark.sql.Dataset[(String, String)] = [_1: string, _2: string]\n"}]},"apps":[],"jobName":"paragraph_1524296620256_1987973720","id":"20180421-074340_1656827177","dateCreated":"2018-04-21T07:43:40+0000","dateStarted":"2018-04-22T21:05:39+0000","dateFinished":"2018-04-22T21:05:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3799"},{"text":"zero_set_transformed.show","user":"anonymous","dateUpdated":"2018-04-21T21:03:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------------------+\n| _1|                  _2|\n+---+--------------------+\n|  0|admission date   ...|\n|  0| admission date  ...|\n|  0| admission date  ...|\n|  0|admission date   ...|\n|  0|admission date   ...|\n|  0|admission date   ...|\n|  0|admission date   ...|\n|  0|name      known l...|\n|  0|admission date   ...|\n|  0|admission date   ...|\n|  0|admission date   ...|\n|  0|admission date   ...|\n|  0|admission date   ...|\n|  0|name      known l...|\n|  0|name     known la...|\n|  0| admission date  ...|\n|  0|admission date   ...|\n|  0| admission date  ...|\n|  0|admission date   ...|\n|  0| admission date  ...|\n+---+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1524296674762_-1571445624","id":"20180421-074434_1014707910","dateCreated":"2018-04-21T07:44:34+0000","dateStarted":"2018-04-21T21:03:36+0000","dateFinished":"2018-04-21T21:03:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3800"},{"text":"//save the transformed files to hdfs\none_set_transformed.write.format(\"com.databricks.spark.csv\").save(\"one_set_processed.csv\")","user":"anonymous","dateUpdated":"2018-04-22T21:07:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1524285231677_-953178956","id":"20180421-043351_308158735","dateCreated":"2018-04-21T04:33:51+0000","dateStarted":"2018-04-21T04:57:08+0000","dateFinished":"2018-04-21T04:57:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3801"},{"text":"zero_set_transformed.write.format(\"com.databricks.spark.csv\").save(\"zero_set_processed.csv\")","user":"anonymous","dateUpdated":"2018-04-22T21:06:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1524296710040_-673010970","id":"20180421-074510_127828095","dateCreated":"2018-04-21T07:45:10+0000","dateStarted":"2018-04-21T07:45:33+0000","dateFinished":"2018-04-21T07:45:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3802"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524285437110_-1474053991","id":"20180421-043717_883552115","dateCreated":"2018-04-21T04:37:17+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3803"}],"name":"Data_processing","id":"2DEM39A25","angularObjects":{"2D5RDPRKP:shared_process":[],"2D66X8G11:shared_process":[],"2D6YFX1WH:shared_process":[],"2D8CJBMCX:shared_process":[],"2D59QTM13:shared_process":[],"2D6E812D3:shared_process":[],"2D889515X:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}